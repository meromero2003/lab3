{"version":3,"names":["_components","require","_data","_i18n","_element","_store","_components2","_lockUnlock","_jsxRuntime","ContentLockControlsPure","clientId","isSelected","templateLock","isLockedByParent","isEditingAsBlocks","useSelect","select","getContentLockingParent","getTemplateLock","getTemporarilyEditingAsBlocks","unlock","blockEditorStore","stopEditingAsBlocks","modifyContentLockBlock","useDispatch","isContentLocked","stopEditingAsBlockCallback","useCallback","showStopEditingAsBlocks","showStartEditingAsBlocks","jsxs","Fragment","children","jsx","BlockControls","group","ToolbarButton","onClick","__","BlockSettingsMenuControls","selectedClientIds","onClose","length","MenuItem","_default","exports","default","edit","hasSupport"],"sources":["@wordpress/block-editor/src/hooks/content-lock-ui.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { ToolbarButton, MenuItem } from '@wordpress/components';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { __ } from '@wordpress/i18n';\nimport { useCallback } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../store';\nimport { BlockControls, BlockSettingsMenuControls } from '../components';\nimport { unlock } from '../lock-unlock';\n\n// The implementation of content locking is mainly in this file, although the mechanism\n// to stop temporarily editing as blocks when an outside block is selected is on component StopEditingAsBlocksOnOutsideSelect\n// at block-editor/src/components/block-list/index.js.\n// Besides the components on this file and the file referenced above the implementation\n// also includes artifacts on the store (actions, reducers, and selector).\n\nfunction ContentLockControlsPure( { clientId, isSelected } ) {\n\tconst { templateLock, isLockedByParent, isEditingAsBlocks } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetContentLockingParent,\n\t\t\t\tgetTemplateLock,\n\t\t\t\tgetTemporarilyEditingAsBlocks,\n\t\t\t} = unlock( select( blockEditorStore ) );\n\t\t\treturn {\n\t\t\t\ttemplateLock: getTemplateLock( clientId ),\n\t\t\t\tisLockedByParent: !! getContentLockingParent( clientId ),\n\t\t\t\tisEditingAsBlocks: getTemporarilyEditingAsBlocks() === clientId,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\n\tconst { stopEditingAsBlocks, modifyContentLockBlock } = unlock(\n\t\tuseDispatch( blockEditorStore )\n\t);\n\tconst isContentLocked =\n\t\t! isLockedByParent && templateLock === 'contentOnly';\n\n\tconst stopEditingAsBlockCallback = useCallback( () => {\n\t\tstopEditingAsBlocks( clientId );\n\t}, [ clientId, stopEditingAsBlocks ] );\n\n\tif ( ! isContentLocked && ! isEditingAsBlocks ) {\n\t\treturn null;\n\t}\n\n\tconst showStopEditingAsBlocks = isEditingAsBlocks && ! isContentLocked;\n\tconst showStartEditingAsBlocks =\n\t\t! isEditingAsBlocks && isContentLocked && isSelected;\n\n\treturn (\n\t\t<>\n\t\t\t{ showStopEditingAsBlocks && (\n\t\t\t\t<>\n\t\t\t\t\t<BlockControls group=\"other\">\n\t\t\t\t\t\t<ToolbarButton onClick={ stopEditingAsBlockCallback }>\n\t\t\t\t\t\t\t{ __( 'Done' ) }\n\t\t\t\t\t\t</ToolbarButton>\n\t\t\t\t\t</BlockControls>\n\t\t\t\t</>\n\t\t\t) }\n\t\t\t{ showStartEditingAsBlocks && (\n\t\t\t\t<BlockSettingsMenuControls>\n\t\t\t\t\t{ ( { selectedClientIds, onClose } ) =>\n\t\t\t\t\t\tselectedClientIds.length === 1 &&\n\t\t\t\t\t\tselectedClientIds[ 0 ] === clientId && (\n\t\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\t\t\tmodifyContentLockBlock( clientId );\n\t\t\t\t\t\t\t\t\tonClose();\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{ __( 'Modify' ) }\n\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</BlockSettingsMenuControls>\n\t\t\t) }\n\t\t</>\n\t);\n}\n\nexport default {\n\tedit: ContentLockControlsPure,\n\thasSupport() {\n\t\treturn true;\n\t},\n};\n"],"mappings":"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","ignoreList":[]}